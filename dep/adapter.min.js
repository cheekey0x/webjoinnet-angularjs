(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.amd?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).adapter=z()})(function(){return function n(p,r,e){function a(f,c){if(!r[f]){if(!p[f]){var k="function"==typeof require&&require;if(!c&&k)return k(f,!0);if(b)return b(f,!0);c=Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}c=r[f]={exports:{}};
p[f][0].call(c.exports,function(b){var d=p[f][1][b];return a(d?d:b)},c,c.exports,n,p,r,e)}return r[f].exports}for(var b="function"==typeof require&&require,c=0;c<e.length;c++)a(e[c]);return a}({1:[function(n,p,r){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,c){return(0<
c?"m="+a:a).trim()+"\r\n"})};e.matchPrefix=function(a,b){return e.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};e.parseCandidate=function(a){a=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],port:parseInt(a[5],10),type:a[7]},c=8;c<a.length;c+=2)switch(a[c]){case "raddr":b.relatedAddress=a[c+1];break;case "rport":b.relatedPort=parseInt(a[c+
1],10);break;case "tcptype":b.tcpType=a[c+1];break;default:b[a[c]]=a[c+1]}return b};e.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.ip);b.push(a.port);var c=a.type;b.push("typ");b.push(c);"host"!==c&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));a.ufrag&&(b.push("ufrag"),
b.push(a.ufrag));return"candidate:"+b.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.numChannels=3===a.length?parseInt(a[2],10):1;return b};e.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==a.numChannels?"/"+a.numChannels:
"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var b={},c=a.substr(a.indexOf(" ")+1).split(";"),f=0;f<c.length;f++)a=c[f].trim().split("="),b[a[0].trim()]=a[1];return b};e.writeFmtp=function(a){var b="",c=a.payloadType;
void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var f=[];Object.keys(a.parameters).forEach(function(b){f.push(b+"="+a.parameters[b])});b+="a=fmtp:"+c+" "+f.join(";")+"\r\n"}return b};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var b="",c=a.payloadType;void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&
a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};e.parseSsrcMedia=function(a){var b=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},f=a.indexOf(":",b);-1<f?(c.attribute=a.substr(b+1,f-b-1),c.value=a.substr(f+1)):c.attribute=a.substr(b+1);return c};e.getMid=function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),
value:a[1]}};e.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:e.matchPrefix(a+b,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,b){var c="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return c};e.getIceParameters=function(a,b){a=e.splitLines(a);a=a.concat(e.splitLines(b));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===
a.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"};e.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(a)[0].split(" "),f=3;f<c.length;f++){var k=c[f],m=e.matchPrefix(a,"a=rtpmap:"+k+" ")[0];if(m){m=e.parseRtpMap(m);var g=e.matchPrefix(a,"a=fmtp:"+k+" ");m.parameters=g.length?e.parseFmtp(g[0]):{};m.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+
k+" ").map(e.parseRtcpFb);b.codecs.push(m);switch(m.name.toUpperCase()){case "RED":case "ULPFEC":b.fecMechanisms.push(m.name.toUpperCase())}}}e.matchPrefix(a,"a=extmap:").forEach(function(a){b.headerExtensions.push(e.parseExtmap(a))});return b};e.writeRtpDescription=function(a,b){var c="";c+="m="+a+" ";c+=0<b.codecs.length?"9":"0";c+=" UDP/TLS/RTP/SAVPF ";c+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";c+="c=IN IP4 0.0.0.0\r\n";
c+="a=rtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){c+=e.writeRtpMap(a);c+=e.writeFmtp(a);c+=e.writeRtcpFb(a)});var f=0;b.codecs.forEach(function(a){a.maxptime>f&&(f=a.maxptime)});0<f&&(c+="a=maxptime:"+f+"\r\n");c+="a=rtcp-mux\r\n";b.headerExtensions.forEach(function(a){c+=e.writeExtmap(a)});return c};e.parseRtpEncodingParameters=function(a){var b=[],c=e.parseRtpParameters(a),f=-1!==c.fecMechanisms.indexOf("RED"),k=-1!==c.fecMechanisms.indexOf("ULPFEC"),m=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===
a.attribute}),g=0<m.length&&m[0].ssrc,d;m=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){a=a.split(" ");a.shift();return a.map(function(a){return parseInt(a,10)})});0<m.length&&1<m[0].length&&m[0][0]===g&&(d=m[0][1]);c.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:g,codecPayloadType:parseInt(a.parameters.apt,10),rtx:{ssrc:d}},b.push(a),f&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:d,mechanism:k?"red+ulpfec":"red"},b.push(a)))});0===b.length&&g&&b.push({ssrc:g});
var h=e.matchPrefix(a,"b=");h.length&&(h=0===h[0].indexOf("b=TIAS:")?parseInt(h[0].substr(7),10):0===h[0].indexOf("b=AS:")?950*parseInt(h[0].substr(5),10)-16E3:void 0,b.forEach(function(a){a.maxBitrate=h}));return b};e.parseRtcpParameters=function(a){var b={},c=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(b.cname=c.value,b.ssrc=c.ssrc);c=e.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=0<c.length;b.compound=0===c.length;
a=e.matchPrefix(a,"a=rtcp-mux");b.mux=0<a.length;return b};e.parseMsid=function(a){var b=e.matchPrefix(a,"a=msid:");if(1===b.length)return a=b[0].substr(7).split(" "),{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,b){b=
void 0!==b?b:2;return"v=0\r\no=thisisadapterortc "+(a?a:e.generateSessionId())+" "+b+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,b,c,f){b=e.writeRtpDescription(a.kind,b);b+=e.writeIceParameters(a.iceGatherer.getLocalParameters());b+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active");b+="a=mid:"+a.mid+"\r\n";b=a.direction?b+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?
b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(c="msid:"+f.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a="+c)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+c),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+c,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+
" cname:"+e.localCName+"\r\n");return b};e.getDirection=function(a,b){a=e.splitLines(a);for(var c=0;c<a.length;c++)switch(a[c]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[c].substr(2)}return b?e.getDirection(b):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};e.isRejected=function(a){return"0"===a.split(" ",2)[1]};p.exports=e},{}],2:[function(n,p,r){r="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{};n=n("./adapter_factory.js");p.exports=n({window:r.window})},{"./adapter_factory.js":3}],3:[function(n,p,r){p.exports=function(e,a){e=e&&e.window;var b={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(c in a)hasOwnProperty.call(a,c)&&(b[c]=a[c]);a=n("./utils");var c=a.log;var f=a.detectBrowser(e),k={browserDetails:f,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings},m=n("./chrome/chrome_shim")||null,g=n("./edge/edge_shim")||
null,d=n("./firefox/firefox_shim")||null,h=n("./safari/safari_shim")||null;switch(f.browser){case "chrome":if(!m||!m.shimPeerConnection||!b.shimChrome){c("Chrome shim is not included in this adapter release.");break}c("adapter.js shimming chrome.");k.browserShim=m;m.shimGetUserMedia(e);m.shimMediaStream(e);a.shimCreateObjectURL(e);m.shimSourceObject(e);m.shimPeerConnection(e);m.shimOnTrack(e);m.shimAddTrackRemoveTrack(e);m.shimGetSendersWithDtmf(e);break;case "firefox":if(!d||!d.shimPeerConnection||
!b.shimFirefox){c("Firefox shim is not included in this adapter release.");break}c("adapter.js shimming firefox.");k.browserShim=d;d.shimGetUserMedia(e);a.shimCreateObjectURL(e);d.shimSourceObject(e);d.shimPeerConnection(e);d.shimOnTrack(e);break;case "edge":if(!g||!g.shimPeerConnection||!b.shimEdge){c("MS edge shim is not included in this adapter release.");break}c("adapter.js shimming edge.");k.browserShim=g;g.shimGetUserMedia(e);a.shimCreateObjectURL(e);g.shimPeerConnection(e);g.shimReplaceTrack(e);
break;case "safari":if(!h||!b.shimSafari){c("Safari shim is not included in this adapter release.");break}c("adapter.js shimming safari.");k.browserShim=h;a.shimCreateObjectURL(e);h.shimRTCIceServerUrls(e);h.shimCallbacksAPI(e);h.shimLocalStreamsAPI(e);h.shimRemoteStreamsAPI(e);h.shimGetUserMedia(e);break;default:c("Unsupported browser!")}return k}},{"./chrome/chrome_shim":4,"./edge/edge_shim":6,"./firefox/firefox_shim":9,"./safari/safari_shim":11,"./utils":12}],4:[function(n,p,r){var e=n("../utils.js"),
a=e.log;p.exports={shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(a){if("object"===typeof a&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=
function(){var c=this;c._ontrackpoly||(c._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(f){var g=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===f.track.id}):{track:f.track};var d=new Event("track");d.track=f.track;d.receiver=g;d.streams=[b.stream];c.dispatchEvent(d)});b.stream.getTracks().forEach(function(f){var g=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===
f.id}):{track:f};var d=new Event("track");d.track=f;d.receiver=g;d.streams=[b.stream];c.dispatchEvent(d)})},c.addEventListener("addstream",c._ontrackpoly));return b.apply(c,arguments)}}},shimAddTrackRemoveTrack:function(a){if(!a.RTCPeerConnection.prototype.addTrack){var b=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=b.apply(this);a._reverseStreams=a._reverseStreams||{};return c.map(function(d){return a._reverseStreams[d.id]})};
var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){var c=this;c._streams=c._streams||{};c._reverseStreams=c._reverseStreams||{};b.getTracks().forEach(function(a){if(c.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!c._reverseStreams[b.id]){var d=new a.MediaStream(b.getTracks());c._streams[b.id]=d;c._reverseStreams[d.id]=b;b=d}f.apply(c,[b])};var k=a.RTCPeerConnection.prototype.removeStream;
a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};k.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};a.RTCPeerConnection.prototype.addTrack=function(b,c){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var d=[].slice.call(arguments,1);if(1!==
d.length||!d[0].getTracks().find(function(a){return a===b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(a){return a.track===b}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(d=this._streams[c.id])?(d.addTrack(b),this.dispatchEvent(new Event("negotiationneeded"))):
(d=new a.MediaStream([b]),this._streams[c.id]=d,this._reverseStreams[d.id]=c,this.addStream(d));return this.getSenders().find(function(a){return a.track===b})};a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===b.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==b)throw new DOMException("Sender was not created by this connection.",
"InvalidAccessError");b._streams=b._streams||{};var d;Object.keys(b._streams).forEach(function(h){b._streams[h].getTracks().find(function(b){return a.track===b})&&(d=b._streams[h])});d&&(1===d.getTracks().length?b.removeStream(d):d.removeTrack(a.track),b.dispatchEvent(new Event("negotiationneeded")))}}},shimGetSendersWithDtmf:function(a){if("object"===typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,
b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var f=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var l=f.apply(this,arguments);l||(l=b(this,a),this._senders.push(l));return l};var k=a.RTCPeerConnection.prototype.removeTrack;
a.RTCPeerConnection.prototype.removeTrack=function(a){k.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var d=this;d._senders=d._senders||[];e.apply(d,[a]);a.getTracks().forEach(function(a){d._senders.push(b(d,a))})};var g=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._senders=b._senders||[];g.apply(b,
[b._streams[a.id]||a]);a.getTracks().forEach(function(a){var d=b._senders.find(function(b){return b.track===a});d&&b._senders.splice(b._senders.indexOf(d),1)})}}else if("object"===typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var d=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=d.apply(a,[]);b.forEach(function(b){b._pc=
a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}},shimSourceObject:function(a){var b=a&&a.URL;"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;this._srcObject=a;this.src&&b.revokeObjectURL(this.src);
a?(this.src=b.createObjectURL(a),a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)}),a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)})):this.src=""}}))},shimPeerConnection:function(b){var c=e.detectBrowser(b);if(b.RTCPeerConnection){var f=b.RTCPeerConnection;b.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var d=[],l=0;l<a.iceServers.length;l++){var c=a.iceServers[l];!c.hasOwnProperty("urls")&&
c.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),c=JSON.parse(JSON.stringify(c)),c.urls=c.url,d.push(c)):d.push(a.iceServers[l])}a.iceServers=d}return new f(a,b)};b.RTCPeerConnection.prototype=f.prototype;Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return f.generateCertificate}})}else b.RTCPeerConnection=function(c,d){a("PeerConnection");c&&c.iceTransportPolicy&&(c.iceTransports=c.iceTransportPolicy);return new b.webkitRTCPeerConnection(c,
d)},b.RTCPeerConnection.prototype=b.webkitRTCPeerConnection.prototype,b.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return b.webkitRTCPeerConnection.generateCertificate}});var k=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(a,b,c){var d=this,h=arguments;if(0<arguments.length&&"function"===typeof a)return k.apply(this,arguments);if(0===k.length&&(0===arguments.length||"function"!==
typeof arguments[0]))return k.apply(this,[]);var f=function(a){var b={};a.result().forEach(function(a){var d={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){d[b]=a.stat(b)});b[d.id]=d});return b},e=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?k.apply(this,[function(a){h[1](e(f(a)))},arguments[0]]):(new Promise(function(a,b){k.apply(d,[function(b){a(e(f(b)))},
b])})).then(b,c)};51>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var d=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){var a=arguments,b=this,c=new Promise(function(l,c){d.apply(b,[a[0],l,c])});return 2>a.length?c:c.then(function(){a[1].apply(null,[])},function(b){3<=a.length&&a[2].apply(null,[b])})}});52>c.version&&["createOffer","createAnswer"].forEach(function(a){var d=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=
function(){var a=this;if(1>arguments.length||1===arguments.length&&"object"===typeof arguments[0]){var b=1===arguments.length?arguments[0]:void 0;return new Promise(function(l,c){d.apply(a,[l,c,b])})}return d.apply(this,arguments)}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var d=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){arguments[0]=new ("addIceCandidate"===a?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return d.apply(this,
arguments)}});var m=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?m.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},shimGetUserMedia:n("./getusermedia")}},{"../utils.js":12,"./getusermedia":5}],5:[function(n,p,r){var e=n("../utils.js"),a=e.log;p.exports=function(b){var c=e.detectBrowser(b),f=b&&b.navigator,k=function(a){if("object"!==typeof a||a.mandatory||a.optional)return a;var b={};Object.keys(a).forEach(function(d){if("require"!==
d&&"advanced"!==d&&"mediaSource"!==d){var c="object"===typeof a[d]?a[d]:{ideal:a[d]};void 0!==c.exact&&"number"===typeof c.exact&&(c.min=c.max=c.exact);var l=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==c.ideal){b.optional=b.optional||[];var h={};"number"===typeof c.ideal?(h[l("min",d)]=c.ideal,b.optional.push(h),h={},h[l("max",d)]=c.ideal):h[l("",d)]=c.ideal;b.optional.push(h)}void 0!==c.exact&&"number"!==typeof c.exact?(b.mandatory=b.mandatory||
{},b.mandatory[l("",d)]=c.exact):["min","max"].forEach(function(a){void 0!==c[a]&&(b.mandatory=b.mandatory||{},b.mandatory[l(a,d)]=c[a])})}});a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced));return b},m=function(b,d){if((b=JSON.parse(JSON.stringify(b)))&&"object"===typeof b.audio){var l=function(a,b,d){b in a&&!(d in a)&&(a[d]=a[b],delete a[b])};b=JSON.parse(JSON.stringify(b));l(b.audio,"autoGainControl","googAutoGainControl");l(b.audio,"noiseSuppression","googNoiseSuppression");b.audio=
k(b.audio)}if(b&&"object"===typeof b.video){var h=b.video.facingMode;h=h&&("object"===typeof h?h:{ideal:h});l=61>c.version;if(!(!h||"user"!==h.exact&&"environment"!==h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||f.mediaDevices.getSupportedConstraints&&f.mediaDevices.getSupportedConstraints().facingMode&&!l)){delete b.video.facingMode;if("environment"===h.exact||"environment"===h.ideal)var q=["back","rear"];else if("user"===h.exact||"user"===h.ideal)q=["front"];if(q)return f.mediaDevices.enumerateDevices().then(function(c){c=
c.filter(function(a){return"videoinput"===a.kind});var l=c.find(function(a){return q.some(function(b){return-1!==a.label.toLowerCase().indexOf(b)})});!l&&c.length&&-1!==q.indexOf("back")&&(l=c[c.length-1]);l&&(b.video.deviceId=h.exact?{exact:l.deviceId}:{ideal:l.deviceId});b.video=k(b.video);a("chrome: "+JSON.stringify(b));return d(b)})}b.video=k(b.video)}a("chrome: "+JSON.stringify(b));return d(b)},g=function(a){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",
DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[a.name]||a.name,message:a.message,constraint:a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};f.getUserMedia=function(a,b,d){m(a,function(a){f.webkitGetUserMedia(a,b,function(a){d(g(a))})})};var d=function(a){return new Promise(function(b,d){f.getUserMedia(a,
b,d)})};f.mediaDevices||(f.mediaDevices={getUserMedia:d,enumerateDevices:function(){return new Promise(function(a){var d={audio:"audioinput",video:"videoinput"};return b.MediaStreamTrack.getSources(function(b){a(b.map(function(a){return{label:a.label,kind:d[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}});if(f.mediaDevices.getUserMedia){var h=f.mediaDevices.getUserMedia.bind(f.mediaDevices);
f.mediaDevices.getUserMedia=function(a){return m(a,function(a){return h(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(g(a))})})}}else f.mediaDevices.getUserMedia=function(a){return d(a)};"undefined"===typeof f.mediaDevices.addEventListener&&(f.mediaDevices.addEventListener=function(){a("Dummy mediaDevices.addEventListener called.")});
"undefined"===typeof f.mediaDevices.removeEventListener&&(f.mediaDevices.removeEventListener=function(){a("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":12}],6:[function(n,p,r){var e=n("../utils"),a=n("./rtcpeerconnection_shim");p.exports={shimGetUserMedia:n("./getusermedia"),shimPeerConnection:function(b){var c=e.detectBrowser(b);if(b.RTCIceGatherer&&(b.RTCIceCandidate||(b.RTCIceCandidate=function(a){return a}),b.RTCSessionDescription||(b.RTCSessionDescription=function(a){return a}),
15025>c.version)){var f=Object.getOwnPropertyDescriptor(b.MediaStreamTrack.prototype,"enabled");Object.defineProperty(b.MediaStreamTrack.prototype,"enabled",{set:function(a){f.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!b.RTCRtpSender||"dtmf"in b.RTCRtpSender.prototype||Object.defineProperty(b.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new b.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=
null));return this._dtmf}});b.RTCPeerConnection=a(b,c.version)},shimReplaceTrack:function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)}}},{"../utils":12,"./getusermedia":7,"./rtcpeerconnection_shim":8}],7:[function(n,p,r){p.exports=function(e){e=e&&e.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},
b=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(c){return b(c).catch(function(b){return Promise.reject(a(b))})}}},{}],8:[function(n,p,r){function e(a){var b=a.filter(function(a){return"audio"===a.kind}),c=a.filter(function(a){return"video"===a.kind});for(a=[];b.length||c.length;)b.length&&a.push(b.shift()),c.length&&a.push(c.shift());return a}function a(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||
a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var l="string"===typeof d;l&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b:c=!0});delete a.url;a.urls=l?d[0]:d;return!!d.length}return!1})}function b(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var d=0;d<b.length;d++)if(b[d].payloadType===a||b[d].preferredPayloadType===
a)return b[d]},h=function(a,b,c,h){a=d(a.parameters.apt,c);b=d(b.parameters.apt,h);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var l=0;l<b.codecs.length;l++){var f=b.codecs[l];if(d.name.toLowerCase()===f.name.toLowerCase()&&d.clockRate===f.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!f.parameters.apt||h(d,f,a.codecs,b.codecs))){f=JSON.parse(JSON.stringify(f));f.numChannels=Math.min(d.numChannels,f.numChannels);c.codecs.push(f);f.rtcpFeedback=
f.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var h=b.headerExtensions[d];if(a.uri===h.uri){c.headerExtensions.push(h);break}}});return c}function c(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer",
"have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}var f=n("sdp");p.exports=function(k,m){var g=function(b){var d=this,c=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){d[a]=c[a].bind(c)});this.needNegotiation=!1;this.canTrickleIceCandidates=this.ondatachannel=this.onnegotiationneeded=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onsignalingstatechange=this.onremovestream=
this.ontrack=this.onaddstream=this.onicecandidate=null;this.localStreams=[];this.remoteStreams=[];this.getLocalStreams=function(){return d.localStreams};this.getRemoteStreams=function(){return d.remoteStreams};this.localDescription=new k.RTCSessionDescription({type:"",sdp:""});this.remoteDescription=new k.RTCSessionDescription({type:"",sdp:""});this.signalingState="stable";this.iceGatheringState=this.iceConnectionState="new";this.iceOptions={gatherPolicy:"all",iceServers:[]};if(b&&b.iceTransportPolicy)switch(b.iceTransportPolicy){case "all":case "relay":this.iceOptions.gatherPolicy=
b.iceTransportPolicy}this.usingBundle=b&&"max-bundle"===b.bundlePolicy;b&&b.iceServers&&(this.iceOptions.iceServers=a(b.iceServers,m));this._config=b||{};this.transceivers=[];this._localIceCandidatesBuffer=[];this._sdpSessionId=f.generateSessionId()};g.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this.dispatchEvent(a);if(null!==this.onicegatheringstatechange)this.onicegatheringstatechange(a)};g.prototype._emitBufferedCandidates=function(){var a=this,b=
f.splitSections(a.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(d){if(d.candidate&&0!==Object.keys(d.candidate).length)b[d.candidate.sdpMLineIndex+1]+="a="+d.candidate.candidate+"\r\n";else for(var c=1;c<b.length;c++)-1===b[c].indexOf("\r\na=end-of-candidates\r\n")&&(b[c]+="a=end-of-candidates\r\n");a.localDescription.sdp=b.join("");a.dispatchEvent(d);if(null!==a.onicecandidate)a.onicecandidate(d);!d.candidate&&"complete"!==a.iceGatheringState&&a.transceivers.every(function(a){return a.iceGatherer&&
"completed"===a.iceGatherer.state})&&"complete"!==a.iceGatheringStateChange&&(a.iceGatheringState="complete",a._emitGatheringStateChange())});this._localIceCandidatesBuffer=[]};g.prototype.getConfiguration=function(){return this._config};g.prototype._createTransceiver=function(a){var b=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,
recvEncodingParameters:null,stream:null,wantReceive:!0};this.usingBundle&&b?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(b=this._createIceAndDtlsTransports(),a.iceTransport=b.iceTransport,a.dtlsTransport=b.dtlsTransport);this.transceivers.push(a);return a};g.prototype.addTrack=function(a,b){for(var d,c=0;c<this.transceivers.length;c++)this.transceivers[c].track||this.transceivers[c].kind!==a.kind||(d=this.transceivers[c]);d||(d=this._createTransceiver(a.kind));
d.track=a;d.stream=b;d.rtpSender=new k.RTCRtpSender(a,d.dtlsTransport);this._maybeFireNegotiationNeeded();return d.rtpSender};g.prototype.addStream=function(a){var b=this;if(15025<=m)this.localStreams.push(a),a.getTracks().forEach(function(d){b.addTrack(d,a)});else{var d=a.clone();a.getTracks().forEach(function(a,b){var c=d.getTracks()[b];a.addEventListener("enabled",function(a){c.enabled=a.enabled})});d.getTracks().forEach(function(a){b.addTrack(a,d)});this.localStreams.push(d)}this._maybeFireNegotiationNeeded()};
g.prototype.removeStream=function(a){a=this.localStreams.indexOf(a);-1<a&&(this.localStreams.splice(a,1),this._maybeFireNegotiationNeeded())};g.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};g.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};g.prototype._createIceGatherer=function(a,b){var d=this,c=new k.RTCIceGatherer(d.iceOptions);
c.onlocalcandidate=function(h){var l=new Event("icecandidate");l.candidate={sdpMid:a,sdpMLineIndex:b};var e=h.candidate;(h=!e||0===Object.keys(e).length)?void 0===c.state&&(c.state="completed"):(e.component=1,l.candidate.candidate=f.writeCandidate(e));e=f.splitSections(d.localDescription.sdp);e[l.candidate.sdpMLineIndex+1]=h?e[l.candidate.sdpMLineIndex+1]+"a=end-of-candidates\r\n":e[l.candidate.sdpMLineIndex+1]+("a="+l.candidate.candidate+"\r\n");d.localDescription.sdp=e.join("");e=(d._pendingOffer?
d._pendingOffer:d.transceivers).every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});switch(d.iceGatheringState){case "new":h||d._localIceCandidatesBuffer.push(l);h&&e&&d._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case "gathering":d._emitBufferedCandidates();if(!h&&(d.dispatchEvent(l),null!==d.onicecandidate))d.onicecandidate(l);if(e){d.dispatchEvent(new Event("icecandidate"));if(null!==d.onicecandidate)d.onicecandidate(new Event("icecandidate"));d.iceGatheringState=
"complete";d._emitGatheringStateChange()}}};return c};g.prototype._createIceAndDtlsTransports=function(){var a=this,b=new k.RTCIceTransport(null);b.onicestatechange=function(){a._updateConnectionState()};var c=new k.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};g.prototype._disposeIceAndDtlsTransports=function(a){var b=
this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};g.prototype._transceive=function(a,c,e){var d=b(a.localCapabilities,a.remoteCapabilities);c&&a.rtpSender&&(d.encodings=a.sendEncodingParameters,d.rtcp={cname:f.localCName,
compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(d.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(d));e&&a.rtpReceiver&&("video"===a.kind&&a.recvEncodingParameters&&15019>m&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),d.encodings=a.recvEncodingParameters,d.rtcp={cname:a.rtcpParameters.cname,compound:a.rtcpParameters.compound},a.sendEncodingParameters.length&&(d.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(d))};g.prototype.setLocalDescription=
function(a){var d=this;if(!c("setLocalDescription",a.type,this.signalingState)){var e=Error("Can not set local "+a.type+" in state "+this.signalingState);e.name="InvalidStateError";2<arguments.length&&"function"===typeof arguments[2]&&k.setTimeout(arguments[2],0,e);return Promise.reject(e)}if("offer"===a.type){if(this._pendingOffer){e=f.splitSections(a.sdp);var g=e.shift();e.forEach(function(a,b){a=f.parseRtpParameters(a);d._pendingOffer[b].localCapabilities=a});this.transceivers=this._pendingOffer;
delete this._pendingOffer}}else if("answer"===a.type){e=f.splitSections(d.remoteDescription.sdp);g=e.shift();var m=0<f.matchPrefix(g,"a=ice-lite").length;e.forEach(function(a,c){var h=d.transceivers[c],e=h.iceGatherer,l=h.iceTransport,k=h.dtlsTransport,w=h.localCapabilities,q=h.remoteCapabilities;if(!f.isRejected(a)&&!h.isDatachannel){var n=f.getIceParameters(a,g);a=f.getDtlsParameters(a,g);m&&(a.role="server");d.usingBundle&&0!==c||(l.start(e,n,m?"controlling":"controlled"),k.start(a));c=b(w,q);
d._transceive(h,0<c.codecs.length,!1)}})}this.localDescription={type:a.type,sdp:a.sdp};switch(a.type){case "offer":this._updateSignalingState("have-local-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+a.type+'"');}var n=1<arguments.length&&"function"===typeof arguments[1];if(n){var w=arguments[1];k.setTimeout(function(){w();"new"===d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange());d._emitBufferedCandidates()},
0)}e=Promise.resolve();e.then(function(){n||("new"===d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),k.setTimeout(d._emitBufferedCandidates.bind(d),500))});return e};g.prototype.setRemoteDescription=function(a){var b=this;if(!c("setRemoteDescription",a.type,this.signalingState)){var d=Error("Can not set remote "+a.type+" in state "+this.signalingState);d.name="InvalidStateError";2<arguments.length&&"function"===typeof arguments[2]&&k.setTimeout(arguments[2],0,
d);return Promise.reject(d)}var e={},g=[];d=f.splitSections(a.sdp);var n=d.shift(),w=0<f.matchPrefix(n,"a=ice-lite").length,x=0<f.matchPrefix(n,"a=group:BUNDLE ").length;this.usingBundle=x;var p=f.matchPrefix(n,"a=ice-options:")[0];this.canTrickleIceCandidates=p?0<=p.substr(14).split(" ").indexOf("trickle"):!1;d.forEach(function(c,d){var h=f.splitLines(c),l=f.getKind(c),q=f.isRejected(c),p=h[0].substr(2).split(" ")[2];h=f.getDirection(c,n);var t=f.parseMsid(c),v=f.getMid(c)||f.generateIdentifier();
if("application"===l&&"DTLS/SCTP"===p)b.transceivers[d]={mid:v,isDatachannel:!0};else{var A=f.parseRtpParameters(c);if(!q){var r=f.getIceParameters(c,n);var B=f.getDtlsParameters(c,n);B.role="client"}p=f.parseRtpEncodingParameters(c);var C=f.parseRtcpParameters(c),D=0<f.matchPrefix(c,"a=end-of-candidates",n).length;c=f.matchPrefix(c,"a=candidate:").map(function(a){return f.parseCandidate(a)}).filter(function(a){return"1"===a.component||1===a.component});("offer"===a.type||"answer"===a.type)&&!q&&
x&&0<d&&b.transceivers[d]&&(b._disposeIceAndDtlsTransports(d),b.transceivers[d].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[d].iceTransport=b.transceivers[0].iceTransport,b.transceivers[d].dtlsTransport=b.transceivers[0].dtlsTransport,b.transceivers[d].rtpSender&&b.transceivers[d].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[d].rtpReceiver&&b.transceivers[d].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport));if("offer"===a.type&&!q){q=b.transceivers[d]||
b._createTransceiver(l);q.mid=v;q.iceGatherer||(q.iceGatherer=x&&0<d?b.transceivers[0].iceGatherer:b._createIceGatherer(v,d));!D||!c.length||x&&0!==d||q.iceTransport.setRemoteCandidates(c);var y=k.RTCRtpReceiver.getCapabilities(l);15019>m&&(y.codecs=y.codecs.filter(function(a){return"rtx"!==a.name}));v=[{ssrc:1001*(2*d+2)}];if("sendrecv"===h||"sendonly"===h){var u=new k.RTCRtpReceiver(q.dtlsTransport,l);r=u.track;t?(e[t.stream]||(e[t.stream]=new k.MediaStream,Object.defineProperty(e[t.stream],"id",
{get:function(){return t.stream}})),Object.defineProperty(r,"id",{get:function(){return t.track}}),e[t.stream].addTrack(r),g.push([r,u,e[t.stream]])):(e.default||(e.default=new k.MediaStream),e.default.addTrack(r),g.push([r,u,e.default]))}q.localCapabilities=y;q.remoteCapabilities=A;q.rtpReceiver=u;q.rtcpParameters=C;q.sendEncodingParameters=v;q.recvEncodingParameters=p;b._transceive(b.transceivers[d],!1,"sendrecv"===h||"sendonly"===h)}else if("answer"===a.type&&!q){q=b.transceivers[d];l=q.iceGatherer;
var E=q.iceTransport;var F=q.dtlsTransport;u=q.rtpReceiver;v=q.sendEncodingParameters;y=q.localCapabilities;b.transceivers[d].recvEncodingParameters=p;b.transceivers[d].remoteCapabilities=A;b.transceivers[d].rtcpParameters=C;x&&0!==d||((w||D)&&c.length&&E.setRemoteCandidates(c),E.start(l,r,"controlling"),F.start(B));b._transceive(q,"sendrecv"===h||"recvonly"===h,"sendrecv"===h||"sendonly"===h);!u||"sendrecv"!==h&&"sendonly"!==h?delete q.rtpReceiver:(r=u.track,t?(e[t.stream]||(e[t.stream]=new k.MediaStream),
e[t.stream].addTrack(r),g.push([r,u,e[t.stream]])):(e.default||(e.default=new k.MediaStream),e.default.addTrack(r),g.push([r,u,e.default])))}}});this.remoteDescription={type:a.type,sdp:a.sdp};switch(a.type){case "offer":this._updateSignalingState("have-remote-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+a.type+'"');}Object.keys(e).forEach(function(a){var c=e[a];if(c.getTracks().length){b.remoteStreams.push(c);var d=new Event("addstream");
d.stream=c;b.dispatchEvent(d);null!==b.onaddstream&&k.setTimeout(function(){b.onaddstream(d)},0);g.forEach(function(a){var d=a[0],f=a[1];if(c.id===a[2].id){var e=new Event("track");e.track=d;e.receiver=f;e.streams=[c];b.dispatchEvent(e);null!==b.ontrack&&k.setTimeout(function(){b.ontrack(e)},0)}})}});k.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),
a.iceTransport.addRemoteCandidate({}))})},4E3);1<arguments.length&&"function"===typeof arguments[1]&&k.setTimeout(arguments[1],0);return Promise.resolve()};g.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._updateSignalingState("closed")};g.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");
this.dispatchEvent(a);if(null!==this.onsignalingstatechange)this.onsignalingstatechange(a)};g.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,k.setTimeout(function(){if(!1!==a.needNegotiation){a.needNegotiation=!1;var b=new Event("negotiationneeded");a.dispatchEvent(b);if(null!==a.onnegotiationneeded)a.onnegotiationneeded(b)}},0))};g.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,
checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){a[b.iceTransport.state]++;a[b.dtlsTransport.state]++});a.connected+=a.completed;var b="new";if(0<a.failed)b="failed";else if(0<a.connecting||0<a.checking)b="connecting";else if(0<a.disconnected)b="disconnected";else if(0<a.new)b="new";else if(0<a.connected||0<a.completed)b="connected";if(b!==this.iceConnectionState&&(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this.dispatchEvent(b),
null!==this.oniceconnectionstatechange))this.oniceconnectionstatechange(b)};g.prototype.createOffer=function(){var a=this;if(this._pendingOffer)throw Error("createOffer called while there is a pending offer.");var b;1===arguments.length&&"function"!==typeof arguments[0]?b=arguments[0]:3===arguments.length&&(b=arguments[2]);var c=this.transceivers.filter(function(a){return"audio"===a.kind}).length,g=this.transceivers.filter(function(a){return"video"===a.kind}).length;if(b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==b.offerToReceiveAudio&&(c=!0===b.offerToReceiveAudio?1:!1===b.offerToReceiveAudio?0:b.offerToReceiveAudio);void 0!==b.offerToReceiveVideo&&(g=!0===b.offerToReceiveVideo?1:!1===b.offerToReceiveVideo?0:b.offerToReceiveVideo)}for(this.transceivers.forEach(function(a){"audio"===a.kind?(c--,0>c&&(a.wantReceive=!1)):"video"===a.kind&&(g--,0>g&&(a.wantReceive=!1))});0<c||0<g;)0<c&&(this._createTransceiver("audio"),c--),0<g&&(this._createTransceiver("video"),g--);var n=e(this.transceivers),p=f.writeSessionBoilerplate(this._sdpSessionId);
n.forEach(function(b,c){var d=b.track,e=b.kind,l=f.generateIdentifier();b.mid=l;b.iceGatherer||(b.iceGatherer=a.usingBundle&&0<c?n[0].iceGatherer:a._createIceGatherer(l,c));l=k.RTCRtpSender.getCapabilities(e);15019>m&&(l.codecs=l.codecs.filter(function(a){return"rtx"!==a.name}));l.codecs.forEach(function(a){"H264"===a.name&&void 0===a.parameters["level-asymmetry-allowed"]&&(a.parameters["level-asymmetry-allowed"]="1")});var h=[{ssrc:1001*(2*c+1)}];d&&15019<=m&&"video"===e&&(h[0].rtx={ssrc:1001*(2*
c+1)+1});b.wantReceive&&(b.rtpReceiver=new k.RTCRtpReceiver(b.dtlsTransport,e));b.localCapabilities=l;b.sendEncodingParameters=h});"max-compat"!==this._config.bundlePolicy&&(p+="a=group:BUNDLE "+n.map(function(a){return a.mid}).join(" ")+"\r\n");p+="a=ice-options:trickle\r\n";n.forEach(function(a,b){p+=f.writeMediaSection(a,a.localCapabilities,"offer",a.stream);p+="a=rtcp-rsize\r\n"});this._pendingOffer=n;b=new k.RTCSessionDescription({type:"offer",sdp:p});arguments.length&&"function"===typeof arguments[0]&&
k.setTimeout(arguments[0],0,b);return Promise.resolve(b)};g.prototype.createAnswer=function(){var a=f.writeSessionBoilerplate(this._sdpSessionId);this.usingBundle&&(a+="a=group:BUNDLE "+this.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");this.transceivers.forEach(function(c,d){if(c.isDatachannel)a+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+c.mid+"\r\n";else{if(c.stream){var e;"audio"===c.kind?e=c.stream.getAudioTracks()[0]:"video"===c.kind&&(e=c.stream.getVideoTracks()[0]);
e&&15019<=m&&"video"===c.kind&&(c.sendEncodingParameters[0].rtx={ssrc:1001*(2*d+2)+1})}d=b(c.localCapabilities,c.remoteCapabilities);!d.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&c.sendEncodingParameters[0].rtx&&delete c.sendEncodingParameters[0].rtx;a+=f.writeMediaSection(c,d,"answer",c.stream);c.rtcpParameters&&c.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var c=new k.RTCSessionDescription({type:"answer",sdp:a});arguments.length&&"function"===typeof arguments[0]&&
k.setTimeout(arguments[0],0,c);return Promise.resolve(c)};g.prototype.addIceCandidate=function(a){if(a){var b=a.sdpMLineIndex;if(a.sdpMid)for(var c=0;c<this.transceivers.length;c++)if(this.transceivers[c].mid===a.sdpMid){b=c;break}var d=this.transceivers[b];if(d){c=0<Object.keys(a.candidate).length?f.parseCandidate(a.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port)||c.component&&"1"!==c.component&&1!==c.component)return Promise.resolve();d.iceTransport.addRemoteCandidate(c);d=f.splitSections(this.remoteDescription.sdp);
d[b+1]+=(c.type?a.candidate.trim():"a=end-of-candidates")+"\r\n";this.remoteDescription.sdp=d.join("")}}else for(b=0;b<this.transceivers.length;b++)if(this.transceivers[b].iceTransport.addRemoteCandidate({}),this.usingBundle)return Promise.resolve();1<arguments.length&&"function"===typeof arguments[1]&&k.setTimeout(arguments[1],0);return Promise.resolve()};g.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(b){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(c){b[c]&&
a.push(b[c].getStats())})});var b=1<arguments.length&&"function"===typeof arguments[1]&&arguments[1];return new Promise(function(c){var d=new Map;Promise.all(a).then(function(a){a.forEach(function(a){Object.keys(a).forEach(function(b){var c=a[b];a[b].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[c.type]||c.type;d.set(b,a[b])})});b&&k.setTimeout(b,0,d);c(d)})})};return g}},{sdp:1}],9:[function(n,
p,r){var e=n("../utils");p.exports={shimOnTrack:function(a){"object"!==typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",this._ontrack=a);this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=
new Event("track");c.track=b;c.receiver={track:b};c.streams=[a.stream];this.dispatchEvent(c)}.bind(this))}.bind(this))}})},shimSourceObject:function(a){"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(a){var b=e.detectBrowser(a);if("object"===typeof a&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){a.RTCPeerConnection||
(a.RTCPeerConnection=function(c,d){if(38>b.version&&c&&c.iceServers){for(var e=[],f=0;f<c.iceServers.length;f++){var k=c.iceServers[f];if(k.hasOwnProperty("urls"))for(var g=0;g<k.urls.length;g++){var m={url:k.urls[g]};0===k.urls[g].indexOf("turn")&&(m.username=k.username,m.credential=k.credential);e.push(m)}else e.push(c.iceServers[f])}c.iceServers=e}return new a.mozRTCPeerConnection(c,d)},a.RTCPeerConnection.prototype=a.mozRTCPeerConnection.prototype,a.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,
"generateCertificate",{get:function(){return a.mozRTCPeerConnection.generateCertificate}}),a.RTCSessionDescription=a.mozRTCSessionDescription,a.RTCIceCandidate=a.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)}});var c=a.RTCPeerConnection.prototype.addIceCandidate;
a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var f=function(a){var b=new Map;Object.keys(a).forEach(function(c){b.set(c,a[c]);b[c]=a[c]});return b},k={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},m=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,
c,e){return m.apply(this,[a||null]).then(function(a){48>b.version&&(a=f(a));if(53>b.version&&!c)try{a.forEach(function(a){a.type=k[a.type]||a.type})}catch(q){if("TypeError"!==q.name)throw q;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:k[b.type]||b.type}))})}return a}).then(c,e)}}},shimGetUserMedia:n("./getusermedia")}},{"../utils":12,"./getusermedia":10}],10:[function(n,p,r){var e=n("../utils"),a=e.log;p.exports=function(b){var c=e.detectBrowser(b),f=b&&b.navigator;b=b&&b.MediaStreamTrack;
var k=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},m=function(b,d,e){var h=function(a){if("object"!==typeof a||a.require)return a;
var b=[];Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"===typeof a[c]?a[c]:{ideal:a[c]};void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c);void 0!==d.exact&&("number"===typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact);if(void 0!==d.ideal){a.advanced=a.advanced||[];var e={};e[c]="number"===typeof d.ideal?{min:d.ideal,max:d.ideal}:d.ideal;a.advanced.push(e);delete d.ideal;Object.keys(d).length||delete a[c]}}});b.length&&
(a.require=b);return a};b=JSON.parse(JSON.stringify(b));38>c.version&&(a("spec: "+JSON.stringify(b)),b.audio&&(b.audio=h(b.audio)),b.video&&(b.video=h(b.video)),a("ff37: "+JSON.stringify(b)));return f.mozGetUserMedia(b,d,function(a){e(k(a))})},g=function(a){return new Promise(function(b,c){m(a,b,c)})};f.mediaDevices||(f.mediaDevices={getUserMedia:g,addEventListener:function(){},removeEventListener:function(){}});f.mediaDevices.enumerateDevices=f.mediaDevices.enumerateDevices||function(){return new Promise(function(a){a([{kind:"audioinput",
deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})};if(41>c.version){var d=f.mediaDevices.enumerateDevices.bind(f.mediaDevices);f.mediaDevices.enumerateDevices=function(){return d().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a;})}}if(49>c.version){var h=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){return h(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),
new DOMException("The object can not be found here.","NotFoundError");return b},function(a){return Promise.reject(k(a))})}}if(!(55<c.version&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var l=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},n=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){"object"===typeof a&&"object"===typeof a.audio&&(a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","mozAutoGainControl"),l(a.audio,
"noiseSuppression","mozNoiseSuppression"));return n(a)};if(b&&b.prototype.getSettings){var p=b.prototype.getSettings;b.prototype.getSettings=function(){var a=p.apply(this,arguments);l(a,"mozAutoGainControl","autoGainControl");l(a,"mozNoiseSuppression","noiseSuppression");return a}}if(b&&b.prototype.applyConstraints){var r=b.prototype.applyConstraints;b.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===typeof a&&(a=JSON.parse(JSON.stringify(a)),l(a,"autoGainControl","mozAutoGainControl"),
l(a,"noiseSuppression","mozNoiseSuppression"));return r.apply(this,[a])}}}f.getUserMedia=function(a,b,d){if(44>c.version)return m(a,b,d);e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");f.mediaDevices.getUserMedia(a).then(b,d)}}},{"../utils":12}],11:[function(n,p,r){var e=n("../utils");p.exports={shimCallbacksAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var b=a.createOffer,c=a.createAnswer,e=a.setLocalDescription,k=a.setRemoteDescription,
m=a.addIceCandidate;a.createOffer=function(a,c){var d=b.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!c)return d;d.then(a,c);return Promise.resolve()};a.createAnswer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return d;d.then(a,b);return Promise.resolve()};var g=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setLocalDescription=g;g=function(a,b,c){a=k.apply(this,[a]);if(!c)return a;a.then(b,c);
return Promise.resolve()};a.setRemoteDescription=g;g=function(a,b,c){a=m.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=g}},shimLocalStreamsAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=
function(a){var b=null;this._localStreams&&this._localStreams.forEach(function(c){c.id===a&&(b=c)});this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)});return b});if(!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]);-1===this._localStreams.indexOf(a)&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(e){b.call(c,e,
a)})};a.RTCPeerConnection.prototype.addTrack=function(a,e){e&&(this._localStreams?-1===this._localStreams.indexOf(e)&&this._localStreams.push(e):this._localStreams=[e]);b.call(this,a,e)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(-1!==b){this._localStreams.splice(b,1);var c=this,e=a.getTracks();this.getSenders().forEach(function(a){-1!==e.indexOf(a.track)&&
c.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(a){"object"===typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),
this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){var b=a.streams[0];this._remoteStreams||(this._remoteStreams=[]);0<=this._remoteStreams.indexOf(b)||(this._remoteStreams.push(b),b=new Event("addstream"),b.stream=a.streams[0],this.dispatchEvent(b))}.bind(this))}}))},shimGetUserMedia:function(a){var b=a&&a.navigator;b.getUserMedia||(b.webkitGetUserMedia?b.getUserMedia=b.webkitGetUserMedia.bind(b):
b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,e,k){b.mediaDevices.getUserMedia(a).then(e,k)}.bind(b)))},shimRTCIceServerUrls:function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,f){if(a&&a.iceServers){for(var c=[],m=0;m<a.iceServers.length;m++){var g=a.iceServers[m];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,c.push(g)):c.push(a.iceServers[m])}a.iceServers=
c}return new b(a,f)};a.RTCPeerConnection.prototype=b.prototype;Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})}}},{"../utils":12}],12:[function(n,p,r){var e=!0,a=!0,b={disableLog:function(a){return"boolean"!==typeof a?Error("Argument type: "+typeof a+". Please use a boolean."):(e=a)?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(b){if("boolean"!==typeof b)return Error("Argument type: "+typeof b+". Please use a boolean.");
a=!b;return"adapter.js deprecation warnings "+(b?"disabled":"enabled")},log:function(){"object"!==typeof window||e||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)},deprecated:function(b,e){a&&console.warn(b+" is deprecated, please use "+e+" instead.")},extractVersion:function(a,b,e){return(a=a.match(b))&&a.length>=e&&parseInt(a[e],10)},detectBrowser:function(a){var b=a&&a.navigator,c={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return c.browser=
"Not a browser.",c;b.mozGetUserMedia?(c.browser="firefox",c.version=this.extractVersion(b.userAgent,/Firefox\/(\d+)\./,1)):b.webkitGetUserMedia?a.webkitRTCPeerConnection?(c.browser="chrome",c.version=this.extractVersion(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):b.userAgent.match(/Version\/(\d+).(\d+)/)?(c.browser="safari",c.version=this.extractVersion(b.userAgent,/AppleWebKit\/(\d+)\./,1)):c.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.":b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/)?
(c.browser="edge",c.version=this.extractVersion(b.userAgent,/Edge\/(\d+).(\d+)$/,2)):b.mediaDevices&&b.userAgent.match(/AppleWebKit\/(\d+)\./)?(c.browser="safari",c.version=this.extractVersion(b.userAgent,/AppleWebKit\/(\d+)\./,1)):c.browser="Not a supported browser.";return c},shimCreateObjectURL:function(a){var c=a&&a.URL;if("object"===typeof a&&a.HTMLMediaElement&&"srcObject"in a.HTMLMediaElement.prototype){var e=c.createObjectURL.bind(c),m=c.revokeObjectURL.bind(c),g=new Map,d=0;c.createObjectURL=
function(a){if("getTracks"in a){var c="polyblob:"+ ++d;g.set(c,a);b.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return c}return e(a)};c.revokeObjectURL=function(a){m(a);g.delete(a)};var h=Object.getOwnPropertyDescriptor(a.HTMLMediaElement.prototype,"src");Object.defineProperty(a.HTMLMediaElement.prototype,"src",{get:function(){return h.get.apply(this)},set:function(a){this.srcObject=g.get(a)||null;return h.set.apply(this,[a])}});var l=a.HTMLMediaElement.prototype.setAttribute;
a.HTMLMediaElement.prototype.setAttribute=function(){2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=g.get(arguments[1])||null);return l.apply(this,arguments)}}}};p.exports={log:b.log,deprecated:b.deprecated,disableLog:b.disableLog,disableWarnings:b.disableWarnings,extractVersion:b.extractVersion,shimCreateObjectURL:b.shimCreateObjectURL,detectBrowser:b.detectBrowser.bind(b)}},{}]},{},[2])(2)});
